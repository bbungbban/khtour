<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/default2}">
<th:block layout:fragment="customTitle">
	<title th:text="${title}"></title>
</th:block>
<th:block layout:fragment="contentsTitle">
	<h2>예약자 정보 상세 조회</h2>
</th:block>
<th:block layout:fragment="customContents">
	<link rel="stylesheet" type="text/css"
		th:href="@{/js/datatables/buttons.dataTables.min.css}">
	<link rel="stylesheet" type="text/css"
		th:href="@{/js/datatables/select.bootstrap4.min.css}">
	<link rel="stylesheet" type="text/css"
		th:href="@{/js/datatables/fixedColumns.bootstrap4.min.css}">
	<div id="List">
		<!-- **********************************  Start ContentsWrap  ********************************** -->

		<div class="row">
			<div class="col-lg-12">
				<div class="card">
					<div class="card-body">
					<form th:action="@{/room/roomReservationSt}" method="get">
						<div class="input-group" style="margin-bottom: 20px; padding-left: 0px;">
							<div class="col-12 col-md-2 col-lg-2 input-group-prepend" style=" padding: 0px; margin-bottom: 20px;">
								<select class="form-control" id="exampleFormControlSelect1"
									name="searchKey" style="font-size: 14px;">
									<option>전체 조회</option>
									<option value="ldgName">숙박업소 이름</option>
									<option value="memberId">예약자 아이디</option>
									<option value="reservationName">예약자 이름</option>
									<option value="userName">이용자 이름</option>
									<option value="reservationPhone">예약자 전화번호</option>
									<option value="usrePhone">이용자 전화번호</option>
								</select>
							</div>
							<input type="text" name="searchValue" class="col-12 col-md-4 col-lg-4 form-control"
								id="formGroupExampleInput" placeholder="검색 키워드를 입력하세요."
								style="font-size: 14px;">
							<div class="input-group-prepend">
								<button type="submit" class="btn btn-outline-danger"
									style="font-size: 14px; background: #ec5552; color: #fff; margin-bottom: 20px;">검색</button>
							</div>
						</div>
					</form>
						<div class="table-responsive">
							<table id="table-selected"
								class="table table-striped table-bordered">
								<thead>
									<tr>
										<th>예약자 아이디</th>
										<th>숙박업소이름</th>
										<th>객실이름</th>
										<th>체크인 날짜</th>
										<th>체크아웃 날짜</th>
										<th>총 숙박일수</th>   
										<th>예약자 이름</th>
										<th>예약자 휴대폰번호</th>
										<th>이용자 이름</th>
										<th>이용자 휴대폰번호</th>
										<th>총 예약금액</th>
										<th>예약날짜</th>
										<th>정보삭제</th>
									</tr>
								</thead>
								<tbody>
									<tr th:if="${not #lists.isEmpty(reservationList)}" th:each="re : ${reservationList}">
										<td th:text="${re.memberId}"></td>
										<td th:text="${re.accommodation.ldgName}"></td>
										<td th:text="${re.roomName}"></td>
										<td th:text="${re.checkInDate}"></td>
										<td th:text="${re.chekOutDate}"></td>
										<td th:text="${re.lodgmentDay}"></td>
										<td th:text="${re.reservationName}"></td>
										<td th:text="${re.reservationPhone}"></td>
										<td th:text="${re.userName}"></td>
										<td th:text="${re.usrePhone}"></td>
										<td th:text="${re.totalPrice}"></td>
										<td th:text="${re.reservationDate}"></td>
										<td><button class="btn btn-danger btn-icon btn-sm mb-1"
										id="swal-delete-reservation"
										th:data-reservationCd="${re.roomReservationCode}"><i class="feather icon-delete"></i></button></td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>


		<!-- **********************************  End ContentsWrap  ********************************** -->
	</div>
</th:block>
<th:block layout:fragment="customBodyScript">
	<!-- delbtn -->
	<script th:src="@{/js/sweetalert2/sweetalert2.min.js}"
		aria-hidden="true"></script>
	<script th:src="@{/js/sweetalert2/sweetalert2-custom.js}"
		aria-hidden="true"></script>
	<!-- datatables -->
	<script th:src="@{/js/datatables/datatables.js}"></script>
	<script th:src="@{/js/datatables/dataTables.buttons.min.js}"></script>
	<script th:src="@{/js/datatables/buttons.flash.min.js}"></script>
	<script th:src="@{/js/datatables/jszip.min.js}"></script>
	<script th:src="@{/js/datatables/pdfmake.min.js}"></script>
	<script th:src="@{/js/datatables/vfs_fonts.js}"></script>
	<script th:src="@{/js/datatables/buttons.html5.min.js}"></script>
	<script th:src="@{/js/datatables/buttons.print.min.js}"></script>
	<!-- fixedHeader -->
	<script th:src="@{/js/datatables/dataTables.fixedHeader.min.js}"></script>
	<!-- dataTables select -->
	<script th:src="@{/js/datatables/dataTables.select.min.js}"></script>
	<!-- dataTables.fixedColumns.min -->
	<script th:src="@{/js/datatables/dataTables.fixedColumns.min.js}"></script>
	<!-- dataTables.rowGroup.min -->
	<script th:src="@{/js/datatables/dataTables.rowGroup.min.js}"></script>
	<!-- custom -->
	<script th:src="@{/js/custom.js}"></script>
	<script>
		$(function(){
			$(document).on('click','#swal-delete-reservation',function(){
				var reservationCd = $(this).attr('data-reservationCd');
			      const swalWithBootstrapButtons = swal.mixin({
			          confirmButtonClass: 'btn btn-success',
			          cancelButtonClass: 'btn btn-danger',
			          buttonsStyling: false,
			        });

			        swalWithBootstrapButtons({
			          title:'예약자 정보가 삭제 됩니다.',
			          text: "정말 정보를 삭제 하시겠어요?",
			          type: 'warning',
			          showCancelButton: true,
			          confirmButtonText: '네',
			          cancelButtonText: '아니오',
			          reverseButtons: false
			        }).then((result) => {
			          if (result.value) {
			            swalWithBootstrapButtons(
			              '정보 삭제 완료',
			              '정상적으로 정보가 삭제 되었습니다.',
			              'success'
			            )
			            location.href = '/room/deletReservationSt?roomReservationCode=' + reservationCd;
			          } else if (
			            // Read more about handling dismissals
			            result.dismiss === swal.DismissReason.cancel
			          ) {
			            swalWithBootstrapButtons(
			              '취소',
			              '예약자 정보가 유지됩니다.',
			              'error'
			            )
			          }
			        });	
			});
			
		});
	</script>
</th:block>
</html>