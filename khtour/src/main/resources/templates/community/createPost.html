<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/default}">
<th:block layout:fragment="customTitle">
	<title th:text="${title}"></title>
</th:block>
<th:block layout:fragment="contentsTitle">
	<h4>포스트 생성</h4>
</th:block>

<th:block layout:fragment="customScript">
	<script>
		$(function() {
			$("#commName").on('change', function(e) {
						var commName = $('select[name="commName"]').val();
							$.ajax({
								url : '/getTagList',
								type : 'post',
								data : {
									'commName' : commName
								},
								dataType : 'json',
								success : function(data) {	
									console.log(data);						  
									console.log(data.length);
									var txt1="<option value='none'>테그 미선택</option>"
										for(var i =0;i<data.length;i++)
										{
											txt1 +='<option value="'+data[i].tagCode+'" '+ 'class="bg-' + data[i].tagColor+'">' + data[i].tagName  +"</option>"	
										}
										console.log(txt1);
										$('#tagOptionUpdate').empty()
										$('#tagOptionUpdate').append(txt1);							
									}	
							});
			});

		});
	</script>
</th:block>


<th:block layout:fragment="customContents">
	<style>
.bg-primary {
	background-color: #AD8B73 !important;
}

.btn.btn-primary {
	background-color: #AD8B73;
	border-color: #AD8B73;
}

.btn.btn-primary:hover{background:#AD8B73;border-color:#background;}
.btn-primary:not(:disabled):not(.disabled).active, .btn-primary:not(:disabled):not(.disabled):active, .show > .btn-primary.dropdown-toggle{
	background: #AD8B73;
	border-color: #AD8B73;
}

a {
	color: #AD8B73;
}
</style>
	<div class="card">
		<div class="card-body">
			<form class="cmxform" id="form2" method="post"
				th:action="@{/addCommPost}">
				<div class="form-group">
					<label for="commName">등록할 커뮤니티</label> 
					<select class="form-control" id="commName" name="commName" th:if="${not #lists.isEmpty(commList)}">
						<option value="none">===커뮤니티 선택===</option>
						<option th:text="${c.commName}" th:each="c: ${commList}"></option>
					</select>
					<div class="form-group" th:if="${#lists.isEmpty(commList)}">
						<input id="commName" class="form-control bg-primary text-white" name="commName" readonly="readonly" th:value="${community.commName}">
					</div>
					<div class="form-group" th:if="${#lists.isEmpty(commList)}">
						<label for="tagCode">등록할 테그</label> <select class="form-control"
							id="tagCode" name="tagCode">
							<option th:if="${not #lists.isEmpty(tagList)}"th:class="'bg-'+ ${t.tagColor}" th:text="${t.tagName}" th:each="t: ${tagList}">
							</option>
						</select>
					</div>
					<div class="form-group" th:if="${not #lists.isEmpty(commList)}">
						<label for="tagCode">등록할 테그</label> 
						<select class="form-control" id="tagOptionUpdate" name="tagCode" >
							
						</select>
					</div>
				</div>
				<div class="form-group">
					<label for="title">제목</label> <input id="title"
						class="form-control" name="title" placeholder="제목">
				</div>
				<div class="form-group">
					<label for="mainText">본문</label>
					<textarea id="mainText" name="mainText" class="form-control"
						rows="10" placeholder="본문내용" required></textarea>
				</div>
				<div class="form-group">
					<label for="picture">사진 업로드</label> <input type="file" id="picture"
						class="form-control" name="picture">
				</div>
				<div class="form-group">
					<input class="submit btn btn-primary pull-right" type="submit"
						value="등록"> <a href="/commDashboard"
						class="btn btn-primary active pull-right" role="button"
						aria-pressed="true">취소</a>
				</div>
			</form>
		</div>
	</div>




</th:block>
<!-- summernote -->


<th:block layout:fragment="customBodyScript">
	<!-- jquery mask -->
	<script src="js/jquery-validation/jquery.validate.min.js"></script>
	<!-- select2 -->
	<script src="js/select2/select2.min.js"></script>
	<script src="js/summernote/summernote.min.js"></script>
	<!-- PRISM -->
	<script th:src="@{/js/prism/prism.js}"></script>
	<!-- custom -->
	<script th:src="@{/js/custom.js}"></script>
</th:block>
</html>