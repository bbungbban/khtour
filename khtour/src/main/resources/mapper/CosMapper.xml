<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ksmart42.khtour.mapper.CosMapper">
	<resultMap type="Cos" id="cosResultMap">
		<id column="cos_code" 					property="cosCode" />
		<result column="member_id" 				property="memberId" />
		<result column="theme_category_code" 	property="themeCategoryCode" />
		<result column="theme_category" 		property="themeCategory" />
		<result column="mus_code" 				property="musCode" />
		<result column="cos_area1" 				property="cosArea1" />
		<result column="cos_area2" 				property="cosArea2" />
		<result column="cos_name" 				property="cosName" />
		<result column="cos_regist" 			property="cosRegist" />
		<result column="cos_open" 				property="cosOpen" />
		<result column="cos_share" 				property="cosShare" />
	</resultMap>
	<!-- 카테고리 조회 -->
	<select id="categoryList" resultMap="cosResultMap">
		SELECT
			theme_category_code
			,theme_category
		FROM
			tb_theme_category
	</select>
	<!-- 코스 등록 SQL -->
	<insert id="addCos" parameterType="Cos">
		INSERT INTO tb_suggest_cos_regist
		(
		 cos_code
		,member_id
		,theme_category_code
		,theme_category
		,mus_code
		,cos_area1
		,cos_area2
		,cos_name
		,cos_regist
		,cos_open
		,cos_share
		) VALUES (
		sf_new_cos_code()
		,#{memberId}
		,#{themeCategoryCode}
		,#{themeCategory}
		,#{musCode}
		,#{cosArea1}
		,#{cosArea2}
		,#{cosName}
		,#{cosRegist}
		,#{cosOpen}
		,#{cosShare}
		);
	</insert>
	<!-- 코드에 따른 코스 조회 SQL -->
	<select id="getCosByCode" parameterType="String" resultMap="cosResultMap">
		SELECT
			 c.cos_code
			,c.member_id
			,c.theme_category_code
			,c.theme_category
			,c.mus_code
			,c.cos_area1
			,c.cos_area2
			,c.cos_name
			,c.cos_regist
			,c.cos_open
			,c.cos_share
		FROM
			tb_suggest_cos_regist AS c
		INNER JOIN
			tb_member AS m
			ON
			c.member_id = m.member_id
		WHERE
			cos_code = #{cosCode};
	</select>

	<!-- 코스 목록 조회 SQL -->
	<select id="getCosList" resultMap="cosResultMap">
		SELECT
			 c.cos_code
			,c.member_id
			,c.theme_category_code
			,c.theme_category
			,c.mus_code
			,c.cos_area1
			,c.cos_area2
			,c.cos_name
			,c.cos_regist
			,c.cos_open
			,c.cos_share
		FROM
			tb_suggest_cos_regist AS c
		INNER JOIN
			tb_member AS m
			ON
			c.member_id = m.member_id;
	</select>

	<!-- 코스 수정 SQL -->
	<update id="modifyCos" parameterType="Cos">
		UPDATE tb_suggest_cos_regist
		<trim prefix="SET" suffixOverrides=",">
			<if test="cosCode != null and cosCode != ''">
				cos_code = #{cosCode},
			</if>
			<if test="memberId != null and memberId != ''">
				member_id = #{memberId},
			</if>
			<if test="themeCategoryCode != null and themeCategoryCode != ''">
				theme_category_code = #{themeCategoryCode},
			</if>
			<if test="themeCategory != null and themeCategory != ''">
				theme_category = #{themeCategory},
			</if>
			<if test="musCode != null and musCode != ''">
				musCode = #{musCode},
			</if>
			<if test="cosArea1 != null and cosArea1 != ''">
				cos_area1 = #{cosArea1},
			</if>
			<if test="cosArea2 != null and cosArea2 != ''">
				cos_area2 = #{cosArea2},
			</if>
			<if test="cosName != null and cosName != ''">
				cos_name = #{cosName},
			</if>
			<if test="cosRegist != null and cosRegist != ''">
				cos_regist = #{cosRegist},
			</if>
			<if test="cosOpen != null and cosOpen != ''">
				cos_open = #{cosOpen},
			</if>
			<if test="cosShare != null and cosShare != ''">
				cos_share = #{cosShare},
			</if>
		</trim>
		WHERE
			cos_code = #{cosCode};
	</update>

	<!-- 코스 정보 삭제 SQL -->
	<delete id="removeCos" parameterType="String">
		DELETE
		FROM
			tb_suggest_cos_regist
		WHERE
			cos_code = #{cosCode};
	</delete>
</mapper>